<!DOCTYPE html>
<html lang="id">
<head>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#007bff">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta charset="UTF-8" />
  <title>Dashboard Stock Opname</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  
  <script>
    if (localStorage.getItem("login") !== "true") {
      window.location.href = "login.html";
    }
  </script>

  <div class="container">
    <h1>📊 Dashboard Stock Opname</h1>

    <!-- Tombol Logout -->
    <div style="text-align: right;">
      <button onclick="logout()" style="background-color:red; color:white; border:none; padding:6px 12px; border-radius:4px;">🔓 Logout</button>
    </div>
    
    <!-- Tombol Akses Cepat -->
    <div class="actions">
      <a href="master-inventory.html" class="btn">📁 Master Inventory</a>
      <a href="create-file.html" class="btn">➕ Buat File Baru</a>
    </div>

    <!-- Daftar File Opname -->
    <h2>📂 Daftar File Opname</h2>
    <ul id="fileList" class="file-list"></ul>
  </div>

    <script>
    function logout() {
      // Jika pakai localStorage
      localStorage.removeItem("login");
      localStorage.removeItem("userEmail");

      // Jika pakai Firebase Auth
      try {
        import('https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js').then(({ getAuth, signOut }) => {
          const auth = getAuth();
          signOut(auth).then(() => {
            console.log("Logout dari Firebase berhasil");
            window.location.href = "login.html";
          }).catch((error) => {
            console.error("Gagal logout Firebase:", error);
          });
        });
      } catch (e) {
        console.warn("Firebase belum digunakan, logout lokal saja");
        window.location.href = "login.html";
      }
    }
  </script>

  <script>
    function loadFiles() {
      const fileList = document.getElementById("fileList");
      const files = JSON.parse(localStorage.getItem("stockOpnameFiles")) || [];

      fileList.innerHTML = "";

      if (files.length === 0) {
        fileList.innerHTML = "<p>Belum ada file dibuat.</p>";
        return;
      }

      files.forEach((file, index) => {
        const li = document.createElement("li");
        li.innerHTML = `
          <a href="input-opname.html?file=${encodeURIComponent(file.name)}" style="text-decoration:none; color:black;">
            <strong>${file.name}</strong><br/>
            <small>Tanggal: ${file.date}</small>
          </a>
        `;
        fileList.appendChild(li);
      });
    }

    window.onload = () => {
      loadFiles();
    };
  </script>
</body>
</html>
